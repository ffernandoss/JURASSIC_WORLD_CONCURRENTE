<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Página de Prueba</title>
  <style>
    body, html {
      height: 100%;
      width: 100%;
      margin: 0;
      font-family: 'Rock Salt', cursive;
      display: flex;
      overflow: hidden;
    }

    .aside-container {
      width: 45%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      color: #fff;
      padding: 20px;
      box-sizing: border-box;
      overflow-y: auto;
      font-family: 'Roboto', sans-serif;
      font-size: 1.2em;
    }

    .image-container {
      width: 55%;
      height: 100%;
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    #background-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      position: absolute;
      z-index: 0;
    }

    #square {
      width: 30px;
      height: 30px;
      background-color: red;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 2;
    }

    .rectangle {
      width: 10%;
      height: 10%;
      background-color: rgba(128, 128, 128, 0.5);
      position: absolute;
      pointer-events: none;
      z-index: 1;
    }

    .rectangle[data-url="isla_herbivoros.html"] {
      top: 15%;
      left: 14%;
    }

    .rectangle[data-url="isla_carnivoros.html"] {
      top: 8%;
      left: 45%;
    }
    .rectangle[data-url="isla_voladores_3.html"] {
      top: 85%;
      left: 50%;
      transform: translateX(-50%);
    }

    .rectangle[data-url="isla_voladores.html"] {
      top: 15%;
      left: 77%;
    }

    .rectangle[data-url="huevos.html"] {
      top: 45%;
      left: 7%;
    }

    .rectangle[data-url="enfermeria.html"] {
      top: 47%;
      left: 84%;
    }

    .rectangle[data-url="isla_herbivoros_2.html"] {
      top: 78%;
      left: 14%;
    }

    .rectangle[data-url="isla_carnivoros_2.html"] {
      top: 82%;
      left: 78%;
    }

    .rectangle[data-url="isla_voladores_2.html"] {
      top: 15%;
      left: 77%;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      color: #fff;
    }

    th, td {
      border: 1px solid #fff;
      padding: 10px;
      text-align: center;
    }

    th {
      background-color: rgba(255, 255, 255, 0.3);
    }
  </style>
</head>
<body>
<div class="aside-container">
  <table>
    <thead>
    <!-- Encabezados eliminados para que la tabla esté vacía -->
    </thead>
    <tbody id="informacion">
    <!-- Contenido dinámico que será llenado desde el backend -->
    </tbody>
  </table>
</div>
<div class="image-container">
  <img id="background-image" src="prueba.webp" alt="Background Image">
  <div id="square"></div>
  <div class="rectangle" data-url="isla_herbivoros.html">Herbivoros</div>
  <div class="rectangle" data-url="isla_carnivoros.html">Carnivoros</div>
  <div class="rectangle" data-url="isla_voladores.html">Voladores</div>
  <div class="rectangle" data-url="huevos.html">Huevos</div>
  <div class="rectangle" data-url="enfermeria.html">Enfermeria</div>
  <div class="rectangle" data-url="isla_herbivoros_2.html">Herbivoros</div>
  <div class="rectangle" data-url="isla_carnivoros_2.html">Carnivoros</div>
  <div class="rectangle" data-url="isla_voladores_2.html">Voladores</div>
  <div class="rectangle" data-url="isla_voladores_3.html">Voladores</div>
</div>

<script>
  document.addEventListener('keydown', function(event) {
    const square = document.getElementById('square');
    const rectangles = document.querySelectorAll('.rectangle');
    const step = 10;
    let top = parseInt(window.getComputedStyle(square).top);
    let left = parseInt(window.getComputedStyle(square).left);

    switch(event.key) {
      case 'w':
        square.style.top = (top - step) + 'px';
        break;
      case 'a':
        square.style.left = (left - step) + 'px';
        break;
      case 's':
        square.style.top = (top + step) + 'px';
        break;
      case 'd':
        square.style.left = (left + step) + 'px';
        break;
      case 'Enter':
        rectangles.forEach(rect => {
          const rectBounds = rect.getBoundingClientRect();
          const squareBounds = square.getBoundingClientRect();
          if (squareBounds.left >= rectBounds.left && squareBounds.right <= rectBounds.right &&
                  squareBounds.top >= rectBounds.top && squareBounds.bottom <= rectBounds.bottom) {
            window.open(rect.getAttribute('data-url'), '_blank', 'width=800,height=600');
          }
        });
        break;
    }
  });

  const eventSource = new EventSource('/sse');

  eventSource.onmessage = function(event) {
    const info = event.data;
    const infoElement = document.getElementById('informacion');
    const newRow = document.createElement('tr');
    const newCell = document.createElement('td');
    newCell.textContent = info;
    newRow.appendChild(newCell);
    infoElement.appendChild(newRow);

    // Guardar la información en localStorage
    const currentInfo = localStorage.getItem('informacion') || '';
    localStorage.setItem('informacion', currentInfo + info + '\n');
  };
</script>
</body>
</html>